{"ast":null,"code":"const path = require('path');\nconst utils = require('./utils');\nconst merge = utils.merge;\nconst bus = utils.bus;\nconst spawn = require('child_process').spawn;\nmodule.exports = function spawnCommand(command, config, eventArgs) {\n  var stdio = ['pipe', 'pipe', 'pipe'];\n  if (config.options.stdout) {\n    stdio = ['pipe', process.stdout, process.stderr];\n  }\n  const env = merge(process.env, {\n    FILENAME: eventArgs[0]\n  });\n  var sh = 'sh';\n  var shFlag = '-c';\n  var spawnOptions = {\n    env: merge(config.options.execOptions.env, env),\n    stdio: stdio\n  };\n  if (!Array.isArray(command)) {\n    command = [command];\n  }\n  if (utils.isWindows) {\n    // if the exec includes a forward slash, reverse it for windows compat\n    // but *only* apply to the first command, and none of the arguments.\n    // ref #1251 and #1236\n    command = command.map(executable => {\n      if (executable.indexOf('/') === -1) {\n        return executable;\n      }\n      return executable.split(' ').map((e, i) => {\n        if (i === 0) {\n          return path.normalize(e);\n        }\n        return e;\n      }).join(' ');\n    });\n    // taken from npm's cli: https://git.io/vNFD4\n    sh = process.env.comspec || 'cmd';\n    shFlag = '/d /s /c';\n    spawnOptions.windowsVerbatimArguments = true;\n  }\n  const args = command.join(' ');\n  const child = spawn(sh, [shFlag, args], spawnOptions);\n  if (config.required) {\n    var emit = {\n      stdout: function (data) {\n        bus.emit('stdout', data);\n      },\n      stderr: function (data) {\n        bus.emit('stderr', data);\n      }\n    };\n\n    // now work out what to bind to...\n    if (config.options.stdout) {\n      child.on('stdout', emit.stdout).on('stderr', emit.stderr);\n    } else {\n      child.stdout.on('data', emit.stdout);\n      child.stderr.on('data', emit.stderr);\n      bus.stdout = child.stdout;\n      bus.stderr = child.stderr;\n    }\n  }\n};","map":{"version":3,"names":["path","require","utils","merge","bus","spawn","module","exports","spawnCommand","command","config","eventArgs","stdio","options","stdout","process","stderr","env","FILENAME","sh","shFlag","spawnOptions","execOptions","Array","isArray","isWindows","map","executable","indexOf","split","e","i","normalize","join","comspec","windowsVerbatimArguments","args","child","required","emit","data","on"],"sources":["C:/Users/789bet/node_modules/nodemon/lib/spawn.js"],"sourcesContent":["const path = require('path');\nconst utils = require('./utils');\nconst merge = utils.merge;\nconst bus = utils.bus;\nconst spawn = require('child_process').spawn;\n\nmodule.exports = function spawnCommand(command, config, eventArgs) {\n  var stdio = ['pipe', 'pipe', 'pipe'];\n\n  if (config.options.stdout) {\n    stdio = ['pipe', process.stdout, process.stderr];\n  }\n\n  const env = merge(process.env, { FILENAME: eventArgs[0] });\n\n  var sh = 'sh';\n  var shFlag = '-c';\n  var spawnOptions = {\n    env: merge(config.options.execOptions.env, env),\n    stdio: stdio,\n  };\n\n  if (!Array.isArray(command)) {\n    command = [command];\n  }\n\n  if (utils.isWindows) {\n    // if the exec includes a forward slash, reverse it for windows compat\n    // but *only* apply to the first command, and none of the arguments.\n    // ref #1251 and #1236\n    command = command.map(executable => {\n      if (executable.indexOf('/') === -1) {\n        return executable;\n      }\n\n      return  executable.split(' ').map((e, i) => {\n        if (i === 0) {\n          return path.normalize(e);\n        }\n        return e;\n      }).join(' ');\n    });\n    // taken from npm's cli: https://git.io/vNFD4\n    sh = process.env.comspec || 'cmd';\n    shFlag = '/d /s /c';\n    spawnOptions.windowsVerbatimArguments = true;\n  }\n\n  const args = command.join(' ');\n  const child = spawn(sh, [shFlag, args], spawnOptions);\n\n  if (config.required) {\n    var emit = {\n      stdout: function (data) {\n        bus.emit('stdout', data);\n      },\n      stderr: function (data) {\n        bus.emit('stderr', data);\n      },\n    };\n\n    // now work out what to bind to...\n    if (config.options.stdout) {\n      child.on('stdout', emit.stdout).on('stderr', emit.stderr);\n    } else {\n      child.stdout.on('data', emit.stdout);\n      child.stderr.on('data', emit.stderr);\n\n      bus.stdout = child.stdout;\n      bus.stderr = child.stderr;\n    }\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}